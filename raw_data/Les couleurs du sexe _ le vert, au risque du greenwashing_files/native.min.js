!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.r=function(exports){Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="/",__webpack_require__(__webpack_require__.s=81)}({1:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"SDK_API_LVL",function(){return SDK_API_LVL}),__webpack_require__.d(__webpack_exports__,"SDK_VERSION",function(){return SDK_VERSION}),__webpack_require__.d(__webpack_exports__,"SDK_MAJOR_VERSION",function(){return SDK_MAJOR_VERSION}),__webpack_require__.d(__webpack_exports__,"SDK_DISMISS_NOTIF_AFTER",function(){return SDK_DISMISS_NOTIF_AFTER}),__webpack_require__.d(__webpack_exports__,"RETRY_MAX_ATTEMPTS",function(){return RETRY_MAX_ATTEMPTS}),__webpack_require__.d(__webpack_exports__,"RETRY_MIN_INTERVAL_MS",function(){return RETRY_MIN_INTERVAL_MS}),__webpack_require__.d(__webpack_exports__,"SSL_SCRIPT_URL",function(){return SSL_SCRIPT_URL}),__webpack_require__.d(__webpack_exports__,"WS_URL",function(){return WS_URL}),__webpack_require__.d(__webpack_exports__,"IS_DEV",function(){return IS_DEV}),__webpack_require__.d(__webpack_exports__,"IS_TEST",function(){return IS_TEST});var SDK_API_LVL=1,SDK_VERSION="2.1.0",SDK_MAJOR_VERSION="2",SDK_DISMISS_NOTIF_AFTER=30,RETRY_MAX_ATTEMPTS=3,RETRY_MIN_INTERVAL_MS=1e3,SSL_SCRIPT_URL="via.batch.com",WS_URL="https://ws.batch.com/web",IS_DEV=!1,IS_TEST=!1},2:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var logger_1=__webpack_require__(3);exports.extractBatch=function(e){return e&&e.data&&e.data.batch?e.data.batch:null},exports.request=function(from,msg,args){return{batch:{from:from,msg:msg,args:args||[]}}},exports.successResponse=function(from,msg,result){return{batch:{from:from,msg:msg,success:!0,result:result}}},exports.errorResponse=function(from,msg,error){return{batch:{error:(error||"Unknwon Error").toString(),from:from,msg:msg,success:!1}}},exports.post=function(from,to,msg,args){return new Promise(function(resolve,reject){var channel=new MessageChannel;channel.port1.onmessage=function(e){var batch=exports.extractBatch(e);batch?batch.success?resolve(batch.result):reject(batch.error):(logger_1.Log.warn("message","("+from+")","invalid response",e),reject("Invalid response"))},to.postMessage(exports.request(from,msg,args),"*",[channel.port2])})},exports.listen=function(from,listener){return window.addEventListener("message",function(e){var batch=exports.extractBatch(e);null!=batch&&batch.from===from&&(logger_1.Log.debug("message","("+from+")","recieved",batch),listener(batch,e))})},exports.postAndForget=function(from,to,msg,args){return to.postMessage(exports.request(from,msg,args),"*")}},3:function(module,exports,__webpack_require__){"use strict";var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var LogLevel,config_1=__webpack_require__(1),message=__importStar(__webpack_require__(2)),window_1=__importDefault(__webpack_require__(4));!function(LogLevel){LogLevel[LogLevel.None=0]="None",LogLevel[LogLevel.Public=1]="Public",LogLevel[LogLevel.Error=2]="Error",LogLevel[LogLevel.Warn=3]="Warn",LogLevel[LogLevel.Info=4]="Info",LogLevel[LogLevel.Trace=5]="Trace",LogLevel[LogLevel.Debug=6]="Debug"}(LogLevel=exports.LogLevel||(exports.LogLevel={}));var publicModuleName="public",instance=new(function(){function Logger(){this.level=LogLevel.Public,this.enabledModules=new Set,this.disabledModules=new Set,this.name="SDK",this.enabledModules.add(publicModuleName),this.loadStorageSettings(),config_1.IS_DEV&&this.addGlobalEventListeners()}return Logger.prototype.loadStorageSettings=function(){var _this=this,safeWindow=window_1.default();if(null!=safeWindow&&"object"==typeof safeWindow.localStorage){"1"===safeWindow.localStorage.getItem("com.batch.private.logger.listeners")&&this.addGlobalEventListeners();var rawLevel=safeWindow.localStorage.getItem("com.batch.private.logger.level");if(null!=rawLevel){var level=+rawLevel;level>=0&&level<=6&&(this.level=level)}try{var rawEnabledModules=safeWindow.localStorage.getItem("com.batch.private.logger.modules.enabled");if(rawEnabledModules){var enabledModules=JSON.parse(rawEnabledModules);Array.isArray(enabledModules)&&enabledModules.forEach(function(m){_this.enableModule(m)})}var rawDisabledModules=safeWindow.localStorage.getItem("com.batch.private.logger.modules.disabled");if(rawDisabledModules){var disabledModules=JSON.parse(rawDisabledModules);Array.isArray(disabledModules)&&disabledModules.forEach(function(m){_this.disableModule(m)})}}catch(_){}}},Logger.prototype.addGlobalEventListeners=function(){var _this=this,safeWindow=window_1.default();null!=safeWindow&&(safeWindow.addEventListener("___batchSDK___.logger.enableModule",function(e){return _this.enableModule(e.module)}),safeWindow.addEventListener("___batchSDK___.logger.disableModule",function(e){return _this.disableModule(e.module)}),safeWindow.addEventListener("___batchSDK___.logger.setLogLevel",function(e){var levelValue;switch(e.level.toLowerCase()){case"none":levelValue=0;break;case"error":levelValue=1;break;case"warn":levelValue=2;break;case"info":levelValue=3;break;case"trace":levelValue=4;break;case"debug":default:levelValue=5}_this.level=levelValue}))},Logger.prototype.enableModule=function(module){this.enabledModules.add(module.toLowerCase())},Logger.prototype.enableTunneling=function(to){this.tunnelingTo=to},Logger.prototype.disableModule=function(module){this.disabledModules.add(module.toLowerCase())},Logger.prototype.isModuleEnabled=function(module){var m=module.toLowerCase();return!this.disabledModules.has(m)&&(this.enabledModules.has("*")||this.enabledModules.has(m))},Logger.prototype.shouldLogForLevel=function(wantedLevel){return this.level>0&&wantedLevel<=this.level},Logger.prototype.logMethodForLevel=function(wantedLevel){var method;switch(wantedLevel){case LogLevel.Public:method=console.log;break;case LogLevel.Error:method=console.error;break;case LogLevel.Info:method=console.info;break;case LogLevel.Warn:method=console.warn;break;case LogLevel.Trace:method=console.trace;break;case LogLevel.Debug:default:method=console.debug}return method||console.log},Logger.prototype.getGroupMethod=function(end){return void 0===end&&(end=!1),end?console.groupEnd:console.group},Logger.prototype.formatPrefix=function(moduleName){return moduleName===publicModuleName?"Batch":"Batch "+this.name+" ["+moduleName+"]"},Logger.prototype.public=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this.log.apply(this,[LogLevel.Public,publicModuleName].concat(args))},Logger.prototype.error=function(module){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];this.log.apply(this,[LogLevel.Error,module].concat(args))},Logger.prototype.warn=function(module){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];this.log.apply(this,[LogLevel.Warn,module].concat(args))},Logger.prototype.info=function(module){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];this.log.apply(this,[LogLevel.Info,module].concat(args))},Logger.prototype.trace=function(module){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];this.log.apply(this,[LogLevel.Trace,module].concat(args))},Logger.prototype.debug=function(module){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];this.log.apply(this,[LogLevel.Debug,module].concat(args))},Logger.prototype.log=function(level,moduleName){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];if(this.tunnelingTo){var a_1=[];args.forEach(function(v){switch(typeof v){case"number":case"string":case"boolean":a_1.push(v);break;case"object":try{a_1.push(v?"["+v.toString()+"]":null)}catch(e){a_1.push("[No toString method]")}break;default:a_1.push("[Unsupported type "+typeof v+"]")}}),message.postAndForget(this.name,this.tunnelingTo,"log",[level,this.name+":"+moduleName].concat(a_1))}level===LogLevel.Public&&(moduleName=publicModuleName),this.isModuleEnabled(moduleName)&&this.shouldLogForLevel(level)&&this.logMethodForLevel(level).apply(console,[this.formatPrefix(moduleName),"-"].concat(args))},Logger.prototype.grouped=function(level,module,groupTitle,lines){if(this.isModuleEnabled(module)&&this.shouldLogForLevel(level)){groupTitle?this.getGroupMethod().apply(console,[this.formatPrefix(module),"-",groupTitle]):this.getGroupMethod().apply(console,[this.formatPrefix(module)]);var logMethod_1=this.logMethodForLevel(level);lines.forEach(function(l){return logMethod_1.apply(console,[l])}),this.getGroupMethod(!0).apply(console,[])}},Logger}()),safeWindow=window_1.default();null!=safeWindow&&safeWindow.addEventListener("message",function(e){var batch=message.extractBatch(e);null!=batch&&"log"===batch.msg&&batch.args&&instance.log.apply(instance,batch.args)}),exports.Log=instance},4:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){return"object"==typeof window?window:null}},81:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var local_sdk_events_1=__importDefault(__webpack_require__(9)),logger_1=__webpack_require__(3),LSKEY="_batch_ui_native_prompt_dismissed",NativeRequest=function(){function NativeRequest(api,config){this.api=api,this.conf=Object.assign({autoShow:!0,backoffDuration:86400},config)}return NativeRequest.prototype.draw=function(state){this.api.runsOnOrigin()?this.conf.autoShow&&this.show():logger_1.Log.public("The 'native' UI component is NOT compatible with Batch SDK's insecure mode.\nPlease make sure you're in a secure environment, and that you didn't set 'sameOrigin: false' on the SDK's configuration.")},NativeRequest.prototype.show=function(force){var _this=this;void 0===force&&(force=!1);var dismissed=+window.localStorage.getItem(LSKEY),now=Math.round((new Date).getTime()/1e3);if(force||!dismissed||0===this.conf.backoffDuration||now-dismissed>this.conf.backoffDuration){if(!this.api.runsOnOrigin())return void logger_1.Log.public("Refusing to show the 'native' UI component in insecure mode.\nPlease make sure you're in a secure environment, and that you didn't set 'sameOrigin: false' on the SDK's configuration.");Notification&&("default"===Notification.permission?Notification.requestPermission(function(){window.localStorage.setItem(LSKEY,Math.round((new Date).getTime()/1e3)+""),_this.api.subscribe()}):this.api.subscribe())}},NativeRequest.prototype.hide=function(){},NativeRequest.prototype.reset=function(){window.localStorage.removeItem(LSKEY)},NativeRequest}();window.batchSDK("ui.register","native",function(api,conf,onDrawnCallback){var native=new NativeRequest(api,conf);return api.on(local_sdk_events_1.default.UiReady,function(_,sub){native.draw(sub),onDrawnCallback(native)}),native})},9:function(module,exports,__webpack_require__){"use strict";var LocalSDKEvent;Object.defineProperty(exports,"__esModule",{value:!0}),function(LocalSDKEvent){LocalSDKEvent.All="*",LocalSDKEvent.ProfileChanged="profileChanged",LocalSDKEvent.SubscriptionChanged="subscriptionChanged",LocalSDKEvent.UiComponentReady="uiComponentReady",LocalSDKEvent.UiComponentDrawn="uiComponentDrawn",LocalSDKEvent.UiReady="uiReady"}(LocalSDKEvent||(LocalSDKEvent={})),exports.default=LocalSDKEvent}});